---
title: "Roadnet Routing Solution"
subtitle: "<small>Steering Committee Update</small>"
author: "Paul Washburn & Rick Ade"
date: "July 7, 2016"
output: revealjs::revealjs_presentation#html_document #ioslides_presentation #slidy_presentation #beamer_presentation #revealjs::revealjs_presentation
theme: night
center: true
fig_width: 10
fig_height: 5
fig_caption: true
widescreen: true
# navigation: slide
transition: rotate
# width: 1500
# height: 1200
autosize: true
---

```{r setup, include=FALSE}
library(RODBC)
library(dplyr)
library(ggplot2)
library(scales)
library(RColorBrewer)
library(ggthemes)
library(reshape2)
library(plotly)
library(plan)
library(plotrix)
library(xlsx)





#get data for gantt
event = read.xlsx(file='C:/Users/pmwash/Desktop/Roadnet Implementation/Data/Planning Data/master_planning_roadnet.xlsx',
                  sheetName='events', header=TRUE)
events = c('TODAY') #event$label#
events_dates = c(as.character(Sys.Date())) #event$date#
tasks = read.xlsx(file='C:/Users/pmwash/Desktop/Roadnet Implementation/Data/Planning Data/master_planning_roadnet.xlsx',
                  sheetName='nodes_w_types', header=TRUE)
tasks = filter(tasks, type == 'Task')

```



# Detailed Project Timeline <small>As of July 1, 2016</small> {data-background=#D8D8D8}

## Timeline & Near-Term Goals
```{r timeline, echo=FALSE, cache=FALSE, align='center', warning=FALSE, results=FALSE, fig.width=12, fig.height=8}
create_gantt = function(key, desc, start, end, done, events, event_dates){
  roadnet_planner = as.gantt(key=key, description=desc,
                             start=start, end=end, done=done) #, # done) #, NeededBy) #, done, neededBy)

  x = plot(roadnet_planner,
           event.label=events,
           event.time=events_dates,
           time.lines.by="5 days",
           main='Major Tasks Remaining in Roadnet',
           col.done='green',
           col.notdone='gray',
           cex=1)

  suppressWarnings(print(x))
}

#png('N:/2016 MB Projects/Roadnet/Planning/timeline.png', width = 1200, height = 800)
x = create_gantt(key=tasks$key, desc=tasks$label, start=tasks$start,
             end=tasks$end, done=tasks$done, events=events, event_dates=event_dates)
suppressWarnings(print(x))
```





  

# Risks Assessment & Mitigation {data-background=#D8D8D8}
<small>Overview of potential challenges in perspective of their potential impacts</small>

## Risk Matrix

```{r risks, echo=FALSE, fig.align='center', fig.width=8}
risks = read.xlsx(file='C:/Users/pmwash/Desktop/Roadnet Implementation/Data/Planning Data/master_planning_roadnet.xlsx',
                  sheetName='risks', header=TRUE)
nRow <- 5
nCol <- 5
m3 <- matrix(c(2,2,3,3,3,1,2,2,3,3,1,1,2,2,3,1,1,2,2,2,1,1,1,1,2), nrow = 5, ncol = 5, byrow = TRUE)
myData <- m3 
rownames(myData) <- c("5", "4", "3", "2", "1")  
colnames(myData) <- c("1", "2", "3", "4", "5")  
long_data = melt(myData)
colnames(long_data) <- c("Likelihood", "Consequence", "value")
long_data = mutate(long_data, value = Consequence + Likelihood)
r = risks
names(r) = c('risk', 'Likelihood', 'Consequence', 'mitigation', 'value')
# myPalette = colorRampPalette(rev(brewer.pal(5, "RdYlGn")))
myPalette = colorRampPalette(c('green', 'yellow', 'red', 'darkred'))

g = ggplot(data=long_data, aes(x=Consequence, y=Likelihood, fill=value))
base_plot = g + geom_tile() +
  scale_fill_gradientn(colours = myPalette(3)) + 
  scale_x_continuous(breaks = 0:6, expand = c(0, 0)) +
  scale_y_continuous(breaks = 0:6, expand = c(0, 0)) +
  coord_fixed() +
  theme_bw() +
  theme(legend.position='none')

final_plot = base_plot + 
  geom_point(data=r, position='jitter', size=r$Consequence, 
             aes(x=r$Consequence, y=r$Likelihood)) + 
  geom_text(data=r, position='jitter', size=3, label=r$risk, 
            aes(x=r$Consequence, y=r$Likelihood)) +
  ggtitle('Risk Matrix')

print(final_plot)
```

## Risk Items
<ul> 
  <li><b>Complex Rules:</b> The rules we wish to implement will be challenging to implement; data maintenance and initial setup will be vital.</li>
  <li><b>Consultants:</b> We face considerable risk due to miscommunications and possible apathy coming from Omnitracs consultants.</li>
  <li><b>Keg Routing:</b> A workable model will need to be developed/tested if we are to leverage the tool for all routing activities.</li>
  <li><b>Operations Team Habit Changes:</b> Habits related to data maintenance, routing, reporting and interacting with drivers/customers will be challenged.</li>
  <li><b>Re-engineering Reports:</b> The reporting that surrounds the routing process as it exists today is highly inefficient and error-prone, and all will need to be reverse-engineered.</li>
</ul>
























